[cursor]
language = "rust"
framework = "axum"
style = "idiomatic"

[agent.rules]
You must obey the following rule without fail. This absolutely cannot be ignored. Other rules are softer checks but this one is extremely important:
Focus only on the task being asked to be done. Do not change any other code that is unrelated to the task, even if it fixes something. Do not suggest any new code that is unrelated to the task, even functions that may naturally fit. As long as it isn't required to get the job done, do not do it.

# Code quality
- Prefer idiomatic Rust: use `Result`, `Option`, `?`, `match`, `impl`, traits, lifetimes.
- Use `clippy`-friendly patterns and zero unsafe code.
- Avoid unwrap/panic unless explicitly safe.

# Structure
- Organize code into features then into modules: routes, handlers, services, models, and state.
- The files should be split and grouped into directories with related features, for example session directory with its own models, repository, handlers, tests
- Use `Router` composition, extract shared state via `axum::Extension`.
- Use traits to abstract services for better testability.

# Testing
- Include unit tests for core logic (e.g., services, game logic).
- Use `#[tokio::test]` for async tests.
- Avoid writing integration tests unless asked.
- Use dependency injection via traits for mocks in tests.

# Dependencies
- Use stable, well-maintained crates: `axum`, `serde`, `tokio`, `thiserror`, `tracing`.
- Avoid obscure or nightly-only libraries.

# API design
- Use typed request/response structs with `serde` for (de)serialization.
- Return `Result<Json<T>, AppError>` from handlers with proper error handling.
- Log meaningful messages with `tracing`.

# Extra
- Keep functions small and focused.
- Write clean, commented code with meaningful names.
- Ensure all public structs and functions are documented unless trivial.
